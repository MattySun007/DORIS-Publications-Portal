{% extends "base.html" %}
{% block title %}Results{% endblock %}
{% block content %}

<div class="navbar navbar-fixed-top" style="min-width: 500px; left: 280px; top: 50px;">
    <h4 class="navbar-text">
        {% if search %}
            {% if length == 1 %}
                Found {{ length }} result for "{{ search }}" in {{ time }} seconds
            {% elif length > 1 %}
                Found {{ length }} results for "{{ search }}" in {{ time }} seconds
            {% else %}
                Found {{ length }} results for "{{ search }}"
            {% endif %}
        {% else %}
            {% if length == 1 %}
                Found {{ length }} result for selected filters in {{ time }} seconds
            {% elif length > 1 %}
                Found {{ length }} results for selected filters in {{ time }} seconds
            {% else %}
                Found {{ length }} results for selected filters
            {% endif %}
        {% endif %}
    </h4>
    <ul class="nav navbar-nav navbar-right" style="padding-right: 45px">
		<div class="btn-group">
			<a type="button" class="btn btn-default navbar-btn" a href="{{ url_for('results', list_view=0) }}">
				<span class="glyphicon glyphicon-th-list"></span> 
			</a>
			<a type="button" class="btn btn-default navbar-btn" href="{{ url_for('results', list_view=1) }}">
				<span class="glyphicon glyphicon-list"></span>
			</a>
		</div>
	</ul>
</div>
<div class="navbar navbar-fixed-top" style="min-width: 500px; left: 280px; top: 100px;">
	<h4 class="navbar-text">
		Displaying <strong>{{start+1}} - {{start+num_results}}</strong> records
	</h4>
    <ul class="nav navbar-nav navbar-right" style="padding-right: 30px">
        <div class="btn-group">
            <button type="button" class="btn navbar-btn">Sort By </button>
            <button type="button" class="btn btn-default dropdown-toggle navbar-btn" data-toggle="dropdown">
                {{ sort_method + ' ' }}<span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu" onclick="$.jStorage.set('scrollPosition', 0);">
                <li><a href="{{ url_for('results', sort='Relevance') }}" >Relevance</a></li>
                <li class="divider"></li>
                <p style="padding-left: 10px; font-weight: bold;">Date</p>
                <li><a href="{{ url_for('results', sort='Date: Newest') }}">Newest</a></li>
                <li><a href="{{ url_for('results', sort='Date: Oldest') }}">Oldest</a></li>
                <li class="divider"></li>
                <p style="padding-left: 10px; font-weight: bold;">Title</p>
                <li><a href="{{ url_for('results', sort='Title: A - Z') }}">A - Z</a></li>
                <li><a href="{{ url_for('results', sort='Title: Z - A') }}">Z - A</a></li>
                <li class="divider"></li>
                <p style="padding-left: 10px; font-weight: bold;">Agency</p>
                <li><a href="{{ url_for('results', sort='Agency: A - Z') }}">A - Z</a></li>
                <li><a href="{{ url_for('results', sort='Agency: Z - A') }}">Z - A</a></li>
            </ul>
        </div>
    </ul>
	<ul class="nav navbar-nav navbar-right" style="padding-right: 30px">
        <div class="btn-group">
            <button type="button" class="btn navbar-btn">Results Per Page</button>
            <button type="button" class="btn btn-default dropdown-toggle navbar-btn" data-toggle="dropdown">
            	{{ num_results }} <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu" onclick="$.jStorage.set('scrollPosition', 0);">
                <li><a href="{{ url_for('results', num_results=10) }}">10</a></li>
                <li><a href="{{ url_for('results', num_results=20) }}">20</a></li>
                <li><a href="{{ url_for('results', num_results=50) }}">50</a></li>
				<li><a href="{{ url_for('results', num_results=100) }}">100</a></li>
            </ul>
        </div>
    </ul>
</div>

<div id="sidebar">
	<div class="col-md-12">
		<form id="result-form" class="form-search" role="form" method="post" action = '/results'>
			<div class="navbar navbar-fixed-top" style="top: 60px; padding-left: 15px; max-width: 280px;">
				<div class="input-group">
					<input type="text" class="form-control" name="user_input" placeholder="Enter Search">
					<span class="input-group-btn">
						<button type="submit" class="btn btn-nyc" id="btn" name="btn" value="Refine / Search" onclick="$.jStorage.set('scrollPosition', 0);">Search</button>
					</span>
				</div>
				<br>
				<input type="checkbox" name="fulltext"> Enable Full-Text Search
				<br><br>
				<div id="selects">
	                <select name="agency[]" id="agencies" class="selectpicker input-medium" multiple data-live-search="true" style="display: none;">
	                    <option value="Aging" >Aging</option>
	                    <option value="Buildings" >Buildings</option>
	                    <option value="Campaign Finance" >Campaign Finance</option>
	                    <option value="Children's Services" >Children's Services</option>
	                    <option value="City Council" >City Council</option>
	                    <option value="City Clerk" >City Clerk</option>
	                    <option value="City Planning" >City Planning</option>
	                    <option value="Citywide Admin Svcs" >Citywide Admin Svcs</option>
	                    <option value="Civilian Complaint" >Civilian Complaint</option>
	                    <option value="Comm - Police Corr" >Comm - Police Corr</option>
	                    <option value="Community Assistance" >Community Assistance</option>
	                    <option value="Comptroller" >Comptroller</option>
	                    <option value="Conflicts of Interest" >Conflicts of Interest</option>
	                    <option value="Consumer Affairs" >Consumer Affairs</option>
	                    <option value="Contracts" >Contracts</option>
	                    <option value="Correction" >Correction</option>
	                    <option value="Criminal Justice Coordinator" >Criminal Justice Coordinator</option>
	                    <option value="Cultural Affairs" >Cultural Affairs</option>
	                    <option value="DOI - Investigation" >DOI - Investigation</option>
	                    <option value="Design/Construction" >Design/Construction</option>
	                    <option value="Disabilities" >Disabilities</option>
	                    <option value="District Atty, NY County" >District Atty, NY County</option>
	                    <option value="Districting Commiss" >Districting Commiss</option>
	                    <option value="Domestic Violence" >Domestic Violence</option>
	                    <option value="Economic Development" >Economic Development</option>
	                    <option value="Education, Dept. of" >Education, Dept. of</option>
	                    <option value="Elections, Board of" >Elections, Board of</option>
	                    <option value="Emergency Mgmt." >Emergency Mgmt.</option>
	                    <option value="Employment" >Employment</option>
	                    <option value="Empowerment Zone" >Empowerment Zone</option>
	                    <option value="Environmental - DEP" >Environmental - DEP</option>
	                    <option value="Environmental - OEC" >Environmental - OEC</option>
	                    <option value="Environmental - ECB" >Environmental - ECB</option>
	                    <option value="Equal Employment" >Equal Employment</option>
	                    <option value="Film/Theatre" >Film/Theatre</option>
	                    <option value="Finance" >Finance</option>
	                    <option value="Fire" >Fire</option>
	                    <option value="FISA" >FISA</option>
	                    <option value="Health and Mental Hyg." >Health and Mental Hyg.</option>
	                    <option value="HealthStat" >HealthStat</option>
	                    <option value="Homeless Services" >Homeless Services</option>
	                    <option value="Hospitals - HHC" >Hospitals - HHC</option>
	                    <option value="Housing - HPD" >Housing - HPD</option>
	                    <option value="Human Rights" >Human Rights</option>
	                    <option value="Human Rsrcs - HRA" >Human Rsrcs - HRA</option>
	                    <option value="Immigrant Affairs" >Immigrant Affairs</option>
	                    <option value="Independent Budget" >Independent Budget</option>
	                    <option value="Info. Tech. and Telecom." >Info. Tech. and Telecom.</option>
	                    <option value="Intergovernmental" >Intergovernmental</option>
	                    <option value="International Affairs" >International Affairs</option>
	                    <option value="Judiciary Committee" >Judiciary Committee</option>
	                    <option value="Juvenile Justice" >Juvenile Justice</option>
	                    <option value="Labor Relations" >Labor Relations</option>
	                    <option value="Landmarks" >Landmarks</option>
	                    <option value="Law Department" >Law Department</option>
	                    <option value="Library - Brooklyn" >Library - Brooklyn</option>
	                    <option value="Library - New York" >Library - New York</option>
	                    <option value="Library - Queens" >Library - Queens</option>
	                    <option value="Loft Board" >Loft Board</option>
	                    <option value="Management and Budget" >Management and Budget</option>
	                    <option value="Mayor" >Mayor</option>
	                    <option value="Metropolitan Transportation Authority" >MTA</option>
	                    <option value="NYCERS" >NYCERS</option>
	                    <option value="Operations" >Operations</option>
	                    <option value="Parks and Recreation" >Parks and Recreation</option>
	                    <option value="Payroll Administration" >Payroll Administration</option>
	                    <option value="Police" >Police</option>
	                    <option value="Police Pension Fund" >Police Pension Fund</option>
	                    <option value="Probation" >Probation</option>
	                    <option value="Public Advocate" >Public Advocate</option>
	                    <option value="Public Health" >Public Health</option>
	                    <option value="Public Housing-NYCHA" >Public Housing-NYCHA</option>
	                    <option value="Records" >Records</option>
	                    <option value="Rent Guidelines" >Rent Guidelines</option>
	                    <option value="Sanitation" >Sanitation</option>
	                    <option value="School Construction" >School Construction</option>
	                    <option value="Small Business Svcs" >Small Business Svcs</option>
	                    <option value="Sports Commission" >Sports Commission</option>
	                    <option value="Standards and Appeal" >Standards and Appeal</option>
	                    <option value="Tax Appeals Tribunal" >Tax Appeals Tribunal</option>
	                    <option value="Tax Commission" >Tax Commission</option>
	                    <option value="Taxi and Limousine" >Taxi and Limousine</option>
	                    <option value="Transportation" >Transportation</option>
	                    <option value="Trials and Hearings" >Trials and Hearings</option>
	                    <option value="Veterans - Military" >Veterans - Military</option>
	                    <option value="Volunteer Center" >Volunteer Center</option>
	                    <option value="Voter Assistance" >Voter Assistance</option>
	                    <option value="Youth & Community" >Youth & Community</option>
	                </select>
	                <br><br>
	                <select name="category[]" id="categories" class="selectpicker" multiple data-live-search="true" style="display: none;">
	                    <option value="Business and Consumers">Business and Consumers</option>
	                    <option value="Cultural/Entertainment">Cultural/Entertainment</option>
	                    <option value="Education">Education</option>
	                    <option value="Environment">Environment</option>
	                    <option value="Finance and Budget">Finance and Budget</option>
	                    <option value="Government Policy">Government Policy</option>
	                    <option value="Health">Health</option>
	                    <option value="Housing and Buildings">Housing and Buildings</option>
	                    <option value="Human Services">Human Services</option>
	                    <option value="Labor Relations">Labor Relations</option>
	                    <option value="Public Safety">Public Safety</option>
	                    <option value="Recreation/Parks">Recreation/Parks</option>
	                    <option value="Sanitation">Sanitation</option>
	                    <option value="Technology">Technology</option>
	                    <option value="Transportation">Transportation</option>
	                </select>
	                <br><br>
	                <select name="type[]" id="types" onfocus="skipcycle=true" onblur="skipcycle=false" class="selectpicker" multiple data-live-search="true" style="display: none;">
	                    <option value="Annual Report">Annual Report</option>
	                    <option value="Audit Report">Audit Report</option>
	                    <option value="Bond Offering - Offical Statements">Bond Offering</option>
	                    <option value="Budget Report">Budget Report</option>
	                    <option value="Consultant Report">Consultant Report</option>
	                    <option value="Guide - Manual">Guide - Manual</option>
	                    <option value="Hearing - Minutes">Hearing - Minutes</option>
	                    <option value="Legislative Document">Legislative Document</option>
	                    <option value="Memoranda - Directive">Memoranda - Directive</option>
	                    <option value="Press Release">Press Release</option>
	                    <option value="Serial Publication">Serial Publication</option>
	                    <option value="Staff Report">Staff Report</option>
	                    <option value="Report">Report</option>
	                </select>
	            </div>
	            <br>
	            <button type="submit" class="btn btn-nyc" id="btn" name="btn" value="Refine / Search" onclick="$.jStorage.set('scrollPosition', 0);">Filter</button>
	            <button type="button" class="btn" id="btn" value="Remove All" style = "background-color:#FF6666;color:white">Remove Filters</button>
			</div>
        </form>
	</div>
</div>

<div id="main" onscroll="$.jStorage.set('scrollPosition', this.scrollTop);">
    {% if not length %}
        <div class="col-md-12">
            <p>Your search did not return any results. Please revise your choice of filter(s). </p>
            <p>Suggestions:</p>
            <ul>
                <li>Change your filter(s)</li>
                <li>Remove all filters</li>
                <li>Start a new search</li>
                <li>Simplify your search</li>
            </ul>
        </div>
    {% else %}
        <div class="col-md-12">
        	<br>
        	{% set count = start + 1 %}
            {% for result in results %}
	            <div class="row">
	                <div class="col-md-12">
	                    <div class="panel panel-result">
	                        <div class="panel-heading">
	                            <h3 class="panel-title">{{ count }}. {{ result.title }}</h3>
	                        </div>
	                        <div class="panel-body">
	                            <h5><b>{{ result.agency }}</b></h5>
	                            <h5>{{ result.category }}</h5>
	                            <p>
	                                <small>{{ result.date_created }}</small>
	                                <small style="padding-left:2em">{{ result.type }}</small>
	                            </p>
								{% if not list_view %}
	                            <p> {{ result.description }} </p>
	                            <p>
	                                {% if result.url != '' %}
	                                <form method="get" action="{{ url_for('publication',id = result.id) }}" style="display: inline-block;">
	                                    <button type="submit" class="btn btn-sm btn-nyc">
	                                        <span class="glyphicon glyphicon-search"></span> View
	                                    </button>
	                                </form>
									<form method="get" action="{{ result.url }}" style="display: inline-block;">
	                                    <button type="submit" class="btn btn-sm btn-nyc">
	                                        <span class="glyphicon glyphicon-save"></span> Save
	                                    </button>
	                                </form>
	                                {% else %}
	                                <form method="get" action="404" style="display: inline-block;">
	                                    <button type="submit" class="btn btn-sm btn-nyc disabled">
	                                        <span class="glyphicon glyphicon-search"></span> View
	                                    </button>
	                                </form>
									<form method="get" action="404" style="display: inline-block;">
	                                    <button type="submit" class="btn btn-sm btn-nyc disabled">
	                                        <span class="glyphicon glyphicon-save"></span> Save
	                                    </button>
	                                </form>
	                                {% endif %}
	                            </p>
	                            {% endif %}
	                        </div>
	                    </div>
	                </div>
	            </div>
				{% set count = count + 1 %}
			{% endfor %}
        {% endif %}
        {{ pagination.links|safe }}
	</div> <!-- col-md-12 -->
</div> <!-- main -->

{% endblock %}